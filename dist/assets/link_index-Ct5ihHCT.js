console.log("JavaScript works.......");const s=document.getElementById("login-modal"),i=document.getElementById("register-form"),c=document.getElementById("login-link"),u=document.getElementById("close-modal"),p=document.getElementById("close-register-modal"),a=document.getElementById("login-button"),y=document.getElementById("sign-up-link"),d=document.getElementById("already-have-account-link");function m(e,o){for(const[n,t]of Object.entries(e)){const l=o.querySelector(`[name="${n}"]`);if(l){let r=l.nextElementSibling;(!r||!r.classList.contains("error-login"))&&(r=document.createElement("p"),r.className="error-login",l.insertAdjacentElement("afterend",r)),r.textContent=t}}}c.addEventListener("click",function(e){e.preventDefault(),this.classList.contains("loginSucces")?window.location.href="index.php?action=logout":s.style.display="block"});y.addEventListener("click",function(e){e.preventDefault(),s.style.display="none",i.style.display="block"});u.addEventListener("click",function(){s.style.display="none"});p.addEventListener("click",function(){i.style.display="none"});window.addEventListener("click",function(e){e.target===s?s.style.display="none":e.target===i&&(i.style.display="none")});a&&a.addEventListener("click",function(e){e.preventDefault();const o=document.getElementById("inputmail").value.trim(),n=document.getElementById("inputpass").value.trim();if(!o||!n){alert("Please fill in both email and password.");return}fetch("index.php?action=login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},credentials:"same-origin",body:`inputmail=${encodeURIComponent(o)}&inputpass=${encodeURIComponent(n)}`}).then(t=>t.json()).then(t=>{t.success?(s.style.display="none",c.classList.replace("login","loginSucces"),c.textContent="Logout",window.location.reload()):m(t.errors,s.querySelector("form"))}).catch(t=>{console.error("Login failed:",t),alert("An error occurred. Please try again.")})});i&&i.querySelector("form").addEventListener("submit",function(e){e.preventDefault();const o=document.getElementById("inputmail-register").value.trim(),n=document.getElementById("inputpass-register").value.trim(),t=document.getElementById("inputpass-confirm-register").value.trim();if(!o||!n||!t){alert("Please fill in all fields.");return}if(n!==t){alert("Passwords do not match.");return}fetch("index.php?action=register",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},credentials:"same-origin",body:`inputmail=${encodeURIComponent(o)}&inputpass=${encodeURIComponent(n)}`}).then(l=>l.json()).then(l=>{l.success?(i.style.display="none",s.style.display="block"):m(l.errors,i.querySelector("form"))}).catch(l=>{console.error("Registration failed:",l),alert("An error occurred. Please try again.")})});d&&d.addEventListener("click",function(e){e.preventDefault(),i.style.display="none",s.style.display="block"});document.querySelector("#searchField").addEventListener("input",function(){const e=this.value.toLowerCase(),o=document.querySelectorAll("a.pokémon_card");e===""?o.forEach(n=>{n.style.display="block"}):o.forEach(n=>{n.querySelector(".pokémon_name").innerText.toLowerCase().indexOf(e)===-1?n.style.display="none":n.style.display="block"})});
